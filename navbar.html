<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SkillToBill Navigation</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/components/navbar.css">
</head>
<body>
  <nav class="navbar">
    <!-- Top Bar -->
    <div class="top-bar">
      <!-- Logo Section -->
      <div class="logo-section">
        <a href="home.html">
          <img src="images/logo.png" alt="SkillToBill Logo" class="logo-img" />
          <span class="logo-text">SkillToBill</span>
        </a>
      </div>

      <!-- Search Box -->
      <div class="nav-search">
        <input type="text" placeholder="Search skills, gigs, people..." aria-label="Search">
      </div>

      <!-- Icons and Hamburger -->
      <div class="nav-icons">
        <span class="material-icons notifications-icon" role="button" tabindex="0" aria-label="Notifications">notifications</span>
        <span class="material-icons profile-icon" role="button" tabindex="0" aria-label="Profile">account_circle</span>
        
        <!-- Hamburger Menu Button -->
        <button class="hamburger-menu" aria-label="Toggle navigation menu" aria-expanded="false">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>

      <!-- Dropdowns -->
      <div class="notifications-menu" role="menu" aria-label="Notifications menu"></div>
    </div>

    <!-- Bottom Bar - Desktop Navigation Links -->
    <div class="bottom-bar">
      <ul class="nav-links" role="navigation" aria-label="Main navigation">
        <li><a href="home.html">Home</a></li>
        <li><a href="marketplace.html">Marketplace</a></li>
        <li><a href="learner-zone.html">Learn</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" role="navigation" aria-label="Mobile navigation">
      <ul class="nav-links">
        <li><a href="home.html">Home</a></li>
        <li><a href="marketplace.html">Marketplace</a></li>
        <li><a href="learner-zone.html">Learn</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
  </nav>

  <script>
    // ========== NAVBAR AUTH STATE SYNC ==========
    function getCurrentUser() {
      const userStr = localStorage.getItem('user');
      const token = localStorage.getItem('token');
      if (!userStr || !token) return null;
      try { return JSON.parse(userStr); } catch (e) { return null; }
    }

    function isLoggedIn() {
      return !!localStorage.getItem('token') && !!getCurrentUser();
    }

    document.addEventListener('DOMContentLoaded', () => {
      const hamburger = document.querySelector('.hamburger-menu');
      const mobileMenu = document.querySelector('.mobile-menu');
      const profileIcon = document.querySelector('.profile-icon');
      const loggedIn = isLoggedIn();

      // Account icon: check token, redirect accordingly
      if (profileIcon) {
        profileIcon.addEventListener('click', (e) => {
          e.stopPropagation();
          window.location.href = loggedIn ? 'profile.html' : 'signup-login.html';
        });
      }

      // Hamburger menu toggle
      if (hamburger) {
        hamburger.addEventListener('click', () => {
          hamburger.classList.toggle('active');
          hamburger.setAttribute('aria-expanded', hamburger.classList.contains('active'));
          mobileMenu?.classList.toggle('active');
        });
      }

      // Close menu on link click
      const mobileLinks = mobileMenu?.querySelectorAll('a');
      mobileLinks?.forEach(link => {
        link.addEventListener('click', () => {
          hamburger?.classList.remove('active');
          hamburger?.setAttribute('aria-expanded', 'false');
          mobileMenu?.classList.remove('active');
        });
      });

      // Close menu on outside click
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.navbar') && hamburger?.classList.contains('active')) {
          hamburger.classList.remove('active');
          hamburger.setAttribute('aria-expanded', 'false');
          mobileMenu?.classList.remove('active');
        }
      });
    });
  </script>
</body>
</html>